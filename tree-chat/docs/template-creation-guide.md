# 思考テンプレート作成ガイド

## 概要
このドキュメントは、新しい思考テンプレートを作成する際の手順と必要な作業を記録したものです。
SWOT分析テンプレートの実装を通じて、必要な工数と処理を明確化しています。

## 必要なコンポーネント

### 1. ページコンポーネント (`/app/sessions/[sessionId]/pages/[pageId]/[template-name]/page.tsx`)

#### 必要な処理：
- [ ] FileSystemProviderでラップ
- [ ] セッションID・ページIDの取得（useParams）
- [ ] ページタイプの初期化（type, name, created_at）
- [ ] フィールドディレクトリの作成
- [ ] 各フィールドの初期値設定
- [ ] データの読み込みと監視（useEffect）
- [ ] レイアウト定義（グリッド or フレックス）
- [ ] CanvasCardコンポーネントの配置

#### 必要な定義：
- テンプレート固有のセクション配列
- グリッドレイアウト設定
- フィールド名とプレースホルダー

### 2. APIエンドポイント (`/app/api/[template-name]/route.ts`)

#### 必要な処理：
- [ ] リクエストボディの型定義
- [ ] LangGraph APIの呼び出し
- [ ] レスポンスの型定義とマッピング
- [ ] エラーハンドリング

#### 必要な設定：
- LangGraph Agent ID（事前に作成が必要）
- APIのURL設定

### 3. サジェスト機能の統合

#### 必要な処理：
- [ ] useCanvasSuggestionsフックの適用
- [ ] APIエンドポイントとの連携設定
- [ ] サジェストの型定義

### 4. ナビゲーション追加

#### 必要な処理：
- [ ] トップページにリンク追加
- [ ] ルーティング設定の確認

## 作成時間の記録

### SWOT分析テンプレート実装

開始時刻: 2025-09-04

#### ステップ1: ページコンポーネント作成
- 作業内容: SWOT分析用のページコンポーネント作成
- 所要時間: **約5分**
- 詳細:
  - リーンキャンバスのコードをベースに修正
  - SWOT固有のレイアウト（2x2グリッド）に変更
  - フィールド定義の作成（4象限の定義）
  - 色とアイコンのカスタマイズ

#### ステップ2: テンプレート一覧ページ作成
- 作業内容: テンプレート選択画面の作成
- 所要時間: **約3分**
- 詳細:
  - test-templates ページの新規作成
  - 各テンプレートへのリンク設置
  - トップページからのナビゲーション追加

#### ステップ3: APIエンドポイント作成
- 作業内容: SWOT分析用のAPI作成
- 所要時間: **未実装**（既存APIを暫定利用中）
- 詳細:
  - 現在はlean-canvas APIを流用
  - 専用のLangGraph Agentが必要

#### 合計所要時間: **約8分**（API除く）

## 再利用可能な部分

### 完全に再利用可能：
- FileSystemProvider
- FSTextInput / FSTextarea コンポーネント
- CanvasCard コンポーネント
- useFileSystem フック
- データ永続化の仕組み

### 部分的に修正が必要：
- useCanvasSuggestions（APIエンドポイントの変更）
- ページレイアウト（テンプレート固有）
- フィールド定義（テンプレート固有）

### 新規作成が必要：
- APIエンドポイント
- テンプレート固有のセクション定義
- （場合によって）LangGraph Agent

## 工数削減の提案

1. **テンプレート生成ツール**: 
   - フィールド定義からページを自動生成
   - APIのボイラープレートコード生成

2. **共通化の推進**:
   - サジェスト機能の汎用化
   - レイアウトパターンのコンポーネント化

3. **設定ファイル方式**:
   - JSONでテンプレート定義
   - 動的なページ生成

## 実装結果の評価

### 成功した点
- **高い再利用性**: 既存コンポーネントの90%以上を再利用
- **短時間実装**: 基本機能は10分以内で実装可能
- **一貫性**: UIとデータ管理の仕組みが統一されている

### 改善が必要な点
- **API作成**: 各テンプレート用のLangGraph Agentが必要
- **サジェスト機能**: APIエンドポイントの切り替えが手動
- **レイアウト**: グリッド定義がまだハードコード

### 競合優位性の評価
**結論: 新しい思考テンプレートを10分以内で追加できる体制が整った**

- ✅ データ永続化の仕組みが完全に汎用化
- ✅ UIコンポーネントの再利用性が高い
- ✅ FileSystemベースで拡張が容易
- ⚠️ AI機能（サジェスト）の追加には追加工数が必要

---

更新履歴:
- 2025-09-04: 初版作成（SWOT分析テンプレート実装開始）